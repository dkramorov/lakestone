function getURLVar(b){var e=[];var d=String(document.location).split("?");if(d[1]){var a=d[1].split("&");for(i=0;i<a.length;i++){var c=a[i].split("=");if(c[0]&&c[1]){e[c[0]]=c[1]}}if(e[b]){return e[b]}else{return""}}}$(document).ready(function(){$(".text-danger").each(function(){var a=$(this).parent().parent();if(a.hasClass("form-group")){a.addClass("has-error")}})});var cart={oneclick:function(b){var c=$(".modal.default");var d=c.find(".content");var a=c.find(".wait-spinner");a.fadeIn(0);d.empty();c.find(".modal-dialog").css({width:""});c.modal("show");d.load("/index.php?route=product/product/oneclick",{product_id:b},function(){c.find(".wait-spinner").fadeOut()})},preorder:function(b){var c=$(".modal.default");var d=c.find(".content");var a=c.find(".wait-spinner");a.fadeIn(0);d.empty();c.find(".modal-dialog").css({width:""});c.modal("show");d.load("/index.php?route=product/product/preorder",{product_id:b},function(){c.find(".wait-spinner").fadeOut()})},add:function(b,f,d){d=(typeof d==="undefined"?0:d);var c=$(".modal.default");var e=c.find(".content");var a=c.find(".wait-spinner");a.fadeIn(0);e.empty();c.find(".modal-dialog").css({width:""});c.modal("show");$.ajax({url:"index.php?route=checkout/cart/add",type:"post",data:"product_id="+b+"&quantity="+(typeof(f)!="undefined"?f:1),dataType:"json",beforeSend:function(){$("#cart > button").button("loading")},complete:function(){$("#cart > button").button("reset")},success:function(g){$(".alert, .text-danger").remove();c.find(".wait-spinner").fadeOut();try{(dataLayer=window.dataLayer||[]).push({ecommerce:{currencyCode:"RUB",add:{products:[{name:window.ProductDetails.name,id:window.ProductDetails.id,price:window.ProductDetails.price,brand:"Lakestone",category:window.ProductDetails.category,quantity:1}]}},goods_id:window.ProductDetails.id,goods_price:window.ProductDetails.price,event:"pixel-mg-event","pixel-mg-event-category":"Enhanced Ecommerce","pixel-mg-event-action":"Adding a Product to a Shopping Cart","pixel-mg-event-non-interaction":"False"})}catch(h){ErrorLog(new MyError("an error in cart.add",h))}if(g.redirect){location=g.redirect}if(g.success){$("#cart .badge").text(g.count);$("#cart .amount").html(g.amount);e.html(g.html)}},error:function(j,g,h){alert(h+"\r\n"+j.statusText+"\r\n"+j.responseText)}})},update:function(b,c,a,d){$.ajax({url:"index.php?route=checkout/cart/edit",type:"post",data:"key="+b+"&quantity="+(typeof(c)!="undefined"?c:1),dataType:"json",beforeSend:function(){$("#cart > button").button("loading")},complete:function(){$("#cart > button").button("reset")},success:function(e){if(typeof a!=="undefined"&&a){location=a}if(e.success){$("#cart .badge").text(e.count);$("#cart .amount").html(e.amount)}if(typeof d==="function"){d(e)}},error:function(g,e,f){alert(f+"\r\n"+g.statusText+"\r\n"+g.responseText)}})},remove:function(b,a,c){$.ajax({url:"index.php?route=checkout/cart/remove",type:"post",data:"key="+b,dataType:"json",beforeSend:function(){$("#cart > button").button("loading")},complete:function(){$("#cart > button").button("reset")},success:function(d){if(typeof a!=="undefined"){location=a}if(d.success){$("#cart .badge").text(d.count);$("#cart .amount").html(d.amount);try{(dataLayer=window.dataLayer||[]).push({ecommerce:{currencyCode:"RUB",remove:{products:[d.removed]}},event:"pixel-mg-event","pixel-mg-event-category":"Enhanced Ecommerce","pixel-mg-event-action":"Removing a Product from a Shopping Cart","pixel-mg-event-non-interaction":"False"})}catch(f){ErrorLog(new MyError("an error in cart.remove",f))}}if(typeof c==="function"){c(d)}},error:function(f,d,e){alert(e+"\r\n"+f.statusText+"\r\n"+f.responseText)}})}};